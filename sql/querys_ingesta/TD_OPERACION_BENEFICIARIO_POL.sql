WITH TMP_POL_TABLA AS (
SELECT
PK
,PARENTESCOBENXINPUT
,PARENTESCOBENVINPUT
,PARENTESCOBENVIINPUT
,PARENTESCOBENVIIINPUT
,PARENTESCOBENVIIIINPUT
,PARENTESCOBENIXINPUT
,PARENTESCOBENIVINPUT
,PARENTESCOBENIINPUT
,PARENTESCOBENIIINPUT
,PARENTESCOBENIIIINPUT
,PARENTESCOBENCIINPUT
,PARENTESCOBENCIIINPUT
,PARENTESCOBENCIIIINPUT
,NOMBRESBENXINPUT
,NOMBRESBENVINPUT
,NOMBRESBENVIINPUT
,NOMBRESBENVIIINPUT
,NOMBRESBENVIIIINPUT
,NOMBRESBENIXINPUT
,NOMBRESBENIVINPUT
,NOMBRESBENIINPUT
,NOMBRESBENIIINPUT
,NOMBRESBENIIIINPUT
,NOMBRESBENCIINPUT
,NOMBRESBENCIIINPUT
,NOMBRESBENCIIIINPUT
,FECHANACBENXINPUT
,FECHANACBENVINPUT
,FECHANACBENVIINPUT
,FECHANACBENVIIINPUT
,FECHANACBENVIIIINPUT
,FECHANACBENIXINPUT
,FECHANACBENIVINPUT
,FECHANACBENIINPUT
,FECHANACBENIIINPUT
,FECHANACBENIIIINPUT
,FECHANACBENCIINPUT
,FECHANACBENCIIINPUT
,FECHANACBENCIIIINPUT
,DOCIDENTIDADBENXINPUT
,DOCIDENTIDADBENVINPUT
,DOCIDENTIDADBENVIINPUT
,DOCIDENTIDADBENVIIINPUT
,DOCIDENTIDADBENVIIIINPUT
,DOCIDENTIDADBENIXINPUT
,DOCIDENTIDADBENIVINPUT
,DOCIDENTIDADBENIINPUT
,DOCIDENTIDADBENIIINPUT
,DOCIDENTIDADBENIIIINPUT
,DOCIDENTIDADBENCIINPUT
,DOCIDENTIDADBENCIIINPUT
,DOCIDENTIDADBENCIIIINPUT
,DISTRIBUCIONBENXINPUT
,DISTRIBUCIONBENVINPUT
,DISTRIBUCIONBENVIINPUT
,DISTRIBUCIONBENVIIINPUT
,DISTRIBUCIONBENVIIIINPUT
,DISTRIBUCIONBENIXINPUT
,DISTRIBUCIONBENIVINPUT
,DISTRIBUCIONBENIINPUT
,DISTRIBUCIONBENIIINPUT
,DISTRIBUCIONBENIIIINPUT
,DISTRIBUCIONBENCIINPUT
,DISTRIBUCIONBENCIIINPUT
,DISTRIBUCIONBENCIIIINPUT
,APEPATERNOBENXINPUT
,APEPATERNOBENVINPUT
,APEPATERNOBENVIINPUT
,APEPATERNOBENVIIINPUT
,APEPATERNOBENVIIIINPUT
,APEPATERNOBENIXINPUT
,APEPATERNOBENIVINPUT
,APEPATERNOBENIINPUT
,APEPATERNOBENIIINPUT
,APEPATERNOBENIIIINPUT
,APEPATERNOBENCIINPUT
,APEPATERNOBENCIIINPUT
,APEPATERNOBENCIIIINPUT
,APEMATERNOBENXINPUT
,APEMATERNOBENVINPUT
,APEMATERNOBENVIINPUT
,APEMATERNOBENVIIINPUT
,APEMATERNOBENVIIIINPUT
,APEMATERNOBENIXINPUT
,APEMATERNOBENIVINPUT
,APEMATERNOBENIINPUT
,APEMATERNOBENIIINPUT
,APEMATERNOBENIIIINPUT
,APEMATERNOBENCIINPUT
,APEMATERNOBENCIIINPUT
,APEMATERNOBENCIIIINPUT
FROM INTERSEGURO.POLVIDATOTALPROTEGIDA
UNION ALL
SELECT
PK
,PARENTESCOBENXINPUT
,PARENTESCOBENVINPUT
,PARENTESCOBENVIINPUT
,PARENTESCOBENVIIINPUT
,PARENTESCOBENVIIIINPUT
,PARENTESCOBENIXINPUT
,PARENTESCOBENIVINPUT
,PARENTESCOBENIINPUT
,PARENTESCOBENIIINPUT
,PARENTESCOBENIIIINPUT
,PARENTESCOBENCIINPUT
,PARENTESCOBENCIIINPUT
,PARENTESCOBENCIIIINPUT
,NOMBRESBENXINPUT
,NOMBRESBENVINPUT
,NOMBRESBENVIINPUT
,NOMBRESBENVIIINPUT
,NOMBRESBENVIIIINPUT
,NOMBRESBENIXINPUT
,NOMBRESBENIVINPUT
,NOMBRESBENIINPUT
,NOMBRESBENIIINPUT
,NOMBRESBENIIIINPUT
,NOMBRESBENCIINPUT
,NOMBRESBENCIIINPUT
,NOMBRESBENCIIIINPUT
,FECHANACBENXINPUT
,FECHANACBENVINPUT
,FECHANACBENVIINPUT
,FECHANACBENVIIINPUT
,FECHANACBENVIIIINPUT
,FECHANACBENIXINPUT
,FECHANACBENIVINPUT
,FECHANACBENIINPUT
,FECHANACBENIIINPUT
,FECHANACBENIIIINPUT
,FECHANACBENCIINPUT
,FECHANACBENCIIINPUT
,FECHANACBENCIIIINPUT
,DOCIDENTIDADBENXINPUT
,DOCIDENTIDADBENVINPUT
,DOCIDENTIDADBENVIINPUT
,DOCIDENTIDADBENVIIINPUT
,DOCIDENTIDADBENVIIIINPUT
,DOCIDENTIDADBENIXINPUT
,DOCIDENTIDADBENIVINPUT
,DOCIDENTIDADBENIINPUT
,DOCIDENTIDADBENIIINPUT
,DOCIDENTIDADBENIIIINPUT
,DOCIDENTIDADBENCIINPUT
,DOCIDENTIDADBENCIIINPUT
,DOCIDENTIDADBENCIIIINPUT
,DISTRIBUCIONBENXINPUT
,DISTRIBUCIONBENVINPUT
,DISTRIBUCIONBENVIINPUT
,DISTRIBUCIONBENVIIINPUT
,DISTRIBUCIONBENVIIIINPUT
,DISTRIBUCIONBENIXINPUT
,DISTRIBUCIONBENIVINPUT
,DISTRIBUCIONBENIINPUT
,DISTRIBUCIONBENIIINPUT
,DISTRIBUCIONBENIIIINPUT
,DISTRIBUCIONBENCIINPUT
,DISTRIBUCIONBENCIIINPUT
,DISTRIBUCIONBENCIIIINPUT
,APEPATERNOBENXINPUT
,APEPATERNOBENVINPUT
,APEPATERNOBENVIINPUT
,APEPATERNOBENVIIINPUT
,APEPATERNOBENVIIIINPUT
,APEPATERNOBENIXINPUT
,APEPATERNOBENIVINPUT
,APEPATERNOBENIINPUT
,APEPATERNOBENIIINPUT
,APEPATERNOBENIIIINPUT
,APEPATERNOBENCIINPUT
,APEPATERNOBENCIIINPUT
,APEPATERNOBENCIIIINPUT
,APEMATERNOBENXINPUT
,APEMATERNOBENVINPUT
,APEMATERNOBENVIINPUT
,APEMATERNOBENVIIINPUT
,APEMATERNOBENVIIIINPUT
,APEMATERNOBENIXINPUT
,APEMATERNOBENIVINPUT
,APEMATERNOBENIINPUT
,APEMATERNOBENIIINPUT
,APEMATERNOBENIIIINPUT
,APEMATERNOBENCIINPUT
,APEMATERNOBENCIIINPUT
,APEMATERNOBENCIIIINPUT
FROM INTERSEGURO.POLSIEMPRESEGURO
UNION ALL
SELECT
PK
,PARENTESCOBENXINPUT
,PARENTESCOBENVINPUT
,PARENTESCOBENVIINPUT
,PARENTESCOBENVIIINPUT
,PARENTESCOBENVIIIINPUT
,PARENTESCOBENIXINPUT
,PARENTESCOBENIVINPUT
,PARENTESCOBENIINPUT
,PARENTESCOBENIIINPUT
,PARENTESCOBENIIIINPUT
,PARENTESCOBENCIINPUT
,PARENTESCOBENCIIINPUT
,PARENTESCOBENCIIIINPUT
,NOMBRESBENXINPUT
,NOMBRESBENVINPUT
,NOMBRESBENVIINPUT
,NOMBRESBENVIIINPUT
,NOMBRESBENVIIIINPUT
,NOMBRESBENIXINPUT
,NOMBRESBENIVINPUT
,NOMBRESBENIINPUT
,NOMBRESBENIIINPUT
,NOMBRESBENIIIINPUT
,NOMBRESBENCIINPUT
,NOMBRESBENCIIINPUT
,NOMBRESBENCIIIINPUT
,FECHANACBENXINPUT
,FECHANACBENVINPUT
,FECHANACBENVIINPUT
,FECHANACBENVIIINPUT
,FECHANACBENVIIIINPUT
,FECHANACBENIXINPUT
,FECHANACBENIVINPUT
,FECHANACBENIINPUT
,FECHANACBENIIINPUT
,FECHANACBENIIIINPUT
,FECHANACBENCIINPUT
,FECHANACBENCIIINPUT
,FECHANACBENCIIIINPUT
,DOCIDENTIDADBENXINPUT
,DOCIDENTIDADBENVINPUT
,DOCIDENTIDADBENVIINPUT
,DOCIDENTIDADBENVIIINPUT
,DOCIDENTIDADBENVIIIINPUT
,DOCIDENTIDADBENIXINPUT
,DOCIDENTIDADBENIVINPUT
,DOCIDENTIDADBENIINPUT
,DOCIDENTIDADBENIIINPUT
,DOCIDENTIDADBENIIIINPUT
,DOCIDENTIDADBENCIINPUT
,DOCIDENTIDADBENCIIINPUT
,DOCIDENTIDADBENCIIIINPUT
,DISTRIBUCIONBENXINPUT
,DISTRIBUCIONBENVINPUT
,DISTRIBUCIONBENVIINPUT
,DISTRIBUCIONBENVIIINPUT
,DISTRIBUCIONBENVIIIINPUT
,DISTRIBUCIONBENIXINPUT
,DISTRIBUCIONBENIVINPUT
,DISTRIBUCIONBENIINPUT
,DISTRIBUCIONBENIIINPUT
,DISTRIBUCIONBENIIIINPUT
,DISTRIBUCIONBENCIINPUT
,DISTRIBUCIONBENCIIINPUT
,DISTRIBUCIONBENCIIIINPUT
,APEPATERNOBENXINPUT
,APEPATERNOBENVINPUT
,APEPATERNOBENVIINPUT
,APEPATERNOBENVIIINPUT
,APEPATERNOBENVIIIINPUT
,APEPATERNOBENIXINPUT
,APEPATERNOBENIVINPUT
,APEPATERNOBENIINPUT
,APEPATERNOBENIIINPUT
,APEPATERNOBENIIIINPUT
,APEPATERNOBENCIINPUT
,APEPATERNOBENCIIINPUT
,APEPATERNOBENCIIIINPUT
,APEMATERNOBENXINPUT
,APEMATERNOBENVINPUT
,APEMATERNOBENVIINPUT
,APEMATERNOBENVIIINPUT
,APEMATERNOBENVIIIINPUT
,APEMATERNOBENIXINPUT
,APEMATERNOBENIVINPUT
,APEMATERNOBENIINPUT
,APEMATERNOBENIIINPUT
,APEMATERNOBENIIIINPUT
,APEMATERNOBENCIINPUT
,APEMATERNOBENCIIINPUT
,APEMATERNOBENCIIIINPUT
FROM INTERSEGURO.POLSEGUROACCIDENTES
UNION ALL
SELECT
PK
,PARENTESCOBENXINPUT
,PARENTESCOBENVINPUT
,PARENTESCOBENVIINPUT
,PARENTESCOBENVIIINPUT
,PARENTESCOBENVIIIINPUT
,PARENTESCOBENIXINPUT
,PARENTESCOBENIVINPUT
,PARENTESCOBENIINPUT
,PARENTESCOBENIIINPUT
,PARENTESCOBENIIIINPUT
,PARENTESCOBENCIINPUT
,PARENTESCOBENCIIINPUT
,PARENTESCOBENCIIIINPUT
,NOMBRESBENXINPUT
,NOMBRESBENVINPUT
,NOMBRESBENVIINPUT
,NOMBRESBENVIIINPUT
,NOMBRESBENVIIIINPUT
,NOMBRESBENIXINPUT
,NOMBRESBENIVINPUT
,NOMBRESBENIINPUT
,NOMBRESBENIIINPUT
,NOMBRESBENIIIINPUT
,NOMBRESBENCIINPUT
,NOMBRESBENCIIINPUT
,NOMBRESBENCIIIINPUT
,FECHANACBENXINPUT
,FECHANACBENVINPUT
,FECHANACBENVIINPUT
,FECHANACBENVIIINPUT
,FECHANACBENVIIIINPUT
,FECHANACBENIXINPUT
,FECHANACBENIVINPUT
,FECHANACBENIINPUT
,FECHANACBENIIINPUT
,FECHANACBENIIIINPUT
,FECHANACBENCIINPUT
,FECHANACBENCIIINPUT
,FECHANACBENCIIIINPUT
,DOCIDENTIDADBENXINPUT
,DOCIDENTIDADBENVINPUT
,DOCIDENTIDADBENVIINPUT
,DOCIDENTIDADBENVIIINPUT
,DOCIDENTIDADBENVIIIINPUT
,DOCIDENTIDADBENIXINPUT
,DOCIDENTIDADBENIVINPUT
,DOCIDENTIDADBENIINPUT
,DOCIDENTIDADBENIIINPUT
,DOCIDENTIDADBENIIIINPUT
,DOCIDENTIDADBENCIINPUT
,DOCIDENTIDADBENCIIINPUT
,DOCIDENTIDADBENCIIIINPUT
,DISTRIBUCIONBENXINPUT
,DISTRIBUCIONBENVINPUT
,DISTRIBUCIONBENVIINPUT
,DISTRIBUCIONBENVIIINPUT
,DISTRIBUCIONBENVIIIINPUT
,DISTRIBUCIONBENIXINPUT
,DISTRIBUCIONBENIVINPUT
,DISTRIBUCIONBENIINPUT
,DISTRIBUCIONBENIIINPUT
,DISTRIBUCIONBENIIIINPUT
,DISTRIBUCIONBENCIINPUT
,DISTRIBUCIONBENCIIINPUT
,DISTRIBUCIONBENCIIIINPUT
,APEPATERNOBENXINPUT
,APEPATERNOBENVINPUT
,APEPATERNOBENVIINPUT
,APEPATERNOBENVIIINPUT
,APEPATERNOBENVIIIINPUT
,APEPATERNOBENIXINPUT
,APEPATERNOBENIVINPUT
,APEPATERNOBENIINPUT
,APEPATERNOBENIIINPUT
,APEPATERNOBENIIIINPUT
,APEPATERNOBENCIINPUT
,APEPATERNOBENCIIINPUT
,APEPATERNOBENCIIIINPUT
,APEMATERNOBENXINPUT
,APEMATERNOBENVINPUT
,APEMATERNOBENVIINPUT
,APEMATERNOBENVIIINPUT
,APEMATERNOBENVIIIINPUT
,APEMATERNOBENIXINPUT
,APEMATERNOBENIVINPUT
,APEMATERNOBENIINPUT
,APEMATERNOBENIIINPUT
,APEMATERNOBENIIIINPUT
,APEMATERNOBENCIINPUT
,APEMATERNOBENCIIINPUT
,APEMATERNOBENCIIIINPUT
FROM INTERSEGURO.POLVIDAPROTEGIDA
)

SELECT   /*+ PARALLEL(2) */
       PRE.NUMEROPOLIZAINPUT            AS NUMERO_POLIZA
      ,PLO.OPERATIONPK                  AS NUMERO_OPERACION
      ,TO_CHAR(COT.AUDITDATE,'YYYY-MM-DD HH24:MI:SS') AS AUDITDATE_SYSTEM_DATE
      ,TO_CHAR(COT.TIME_STAMP,'YYYY-MM-DD HH24:MI:SS') AS OPERATION_DATETIME
      ,AGR.PRODUCTID                    AS ID_PRODUCTO
      ,TRIM(UPPER(POR.DESCRIPTION))     AS NOMBRE_PRODUCTO
      ,(CASE WHEN COT.STATUS = 1
             THEN 'Not applied operation' 
             WHEN COT.STATUS = 2 
             THEN 'Applied operation'
             ELSE ''||COT.STATUS
      END ) AS STATUS_OPERATION
    ,POLL.*
       FROM INTERSEGURO.PREPOLICY PRE
 INNER JOIN INTERSEGURO.POLICYDCO PLO
         ON PLO.DCOID = PRE.PK
 INNER JOIN INTERSEGURO.CONTEXTOPERATION COT
         ON COT.ID =PLO.OPERATIONPK
 INNER JOIN INTERSEGURO.AGREGATEDPOLICY AGR
         ON AGR.AGREGATEDPOLICYID = PLO.AGREGATEDOBJECTID
 INNER JOIN INTERSEGURO.PRODUCT POR
         ON POR.PRODUCTID = AGR.PRODUCTID
-- DATOS DE LA POLIZA
 INNER JOIN TMP_POL_TABLA POLL
         ON POLL.PK = PRE.PK
 WHERE PRE.NUMEROPOLIZAINPUT IS NOT NULL
		-- AND COT.AUDITDATE >= (CURRENT_DATE-5)
         AND DATE_TRUNC('day', COT.AUDITDATE) BETWEEN TO_DATE('${v_FechaInicioYYYYMMDD}', 'YYYYMMDD') AND TO_DATE('${v_FechaFinYYYYMMDD}', 'YYYYMMDD');
